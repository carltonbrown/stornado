#!/usr/bin/env ruby
require 'stornado'

options = {}
options[:repo_config] = Dir.home + '/.stornado/repo-config.json'

OptionParser.new do |opts|
  opts.banner = "Usage: stornado [options]"

  opts.on("-r FILE", "Repo config file") do |f|
    options[:repo_config] = f
    puts "Using repo config file #{options[:repo_config]}"
  end

  opts.on("-p PROXY", "Proxy (as defined in config file)") do |proxy|
    options[:proxy_name] = proxy
  end
end.parse!

config = Configuration.new(options[:repo_config])
config.set_proxy(options[:proxy_name])

main_menu = ARGV.shift

result = MenuCommands.send(main_menu, config, ARGV).call
